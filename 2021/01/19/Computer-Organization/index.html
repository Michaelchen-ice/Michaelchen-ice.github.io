<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-27M108WHHV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-27M108WHHV');
</script>
  

  <!-- Baidu Tongji -->
  
  <script type="text/javascript">
    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f9baec644ce7faa66f367b8aabba6c33";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  

  <!-- Baidu Push -->
  

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="google-site-verification" content="AKzfeQZUzfWjttcaIfvMHE2HAy7WVUClzGOjDne7ruM" />

  <meta name="baidu-site-verification" content="code-aZc2G4JX86" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="It&#39;s an IT blog..." />
  <meta name="keyword" content="MichaelChen,Michael,Fight For Life,IT blog,Blog" />
  <link rel="shortcut icon" href="/img/avatar/Cache.jpg" />

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>
  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/beantech.min.css" />

  <!-- Pygments Highlight CSS -->
  
<link rel="stylesheet" href="../../../../css/highlight.css">
<link rel="stylesheet" href="../../../../css/widget.css">
<link rel="stylesheet" href="../../../../css/rocket.css">
<link rel="stylesheet" href="../../../../css/signature.css">
<link rel="stylesheet" href="../../../../css/catalog.css">
<link rel="stylesheet" href="../../../../css/livemylife.css">


  
  <!-- wave start -->
  <link rel="stylesheet" href="/css/wave.css" />
  <!-- wave end -->
  

  
  <!-- top start (article top hot config) -->
  <link rel="stylesheet" href="/css/top.css" />
  <!-- top end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/css/scroll.css" />
  <!-- ThemeColor end -->
  

  
  <!-- viewer start (Picture preview) -->
  <link rel="stylesheet" href="/css/viewer.min.css" />
  <!-- viewer end -->
  

  
  <!-- Search start -->
  <link rel="stylesheet" href="/css/search.css" />
  <!-- Search end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/css/themecolor.css" />
  <!-- ThemeColor end -->
  

  

  
  <!-- gitalk start -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
  <link rel="stylesheet" href="/css/gitalk.css" />
  <!-- gitalk end -->
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
    href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="https://michaelchen-ice.github.io/2021/01/19/Computer-Organization/">
  <title>
    
    Computer Organization - Fight | or Die
    
  </title>
<meta name="generator" content="Hexo 4.2.1"></head>


<!-- hack iOS CSS :active style -->

<body ontouchstart="" class="body--home">
	<!-- ThemeColor -->
	
	<!-- ThemeColor -->
<!-- <div class="toggle" onclick="document.body.classList.toggle('body--dark')">Switch Color</div> -->

<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons bright-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>

	

	<!-- Gitter -->
	
	<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'your-community/your-room'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

	

	<!-- Navigation (contains search)-->
	<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Life Is Like a Battle Field</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">Home</a>
          </li>

          

          
          

          
          <li>
            <a href="/archive/">Archives</a>
          </li>
          
          

          
          <li>
            <a href="/categories/">Categories</a>
          </li>
          
          

          
          <li>
            <a href="/tags/">Tags</a>
          </li>
          
          

          
          <li>
            <a href="/about/">About</a>
          </li>
          
          

          
          <li><a class="popup-trigger" title="Search"><span class="search-icon"></span>Search</a></li>
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>


<script>
  // Drop Bootstarp low-performance Navbar
  // Use customize navbar with high-quality material design animation
  // in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


	<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    header.intro-header {
       /*post*/
        background-image: url('https://w.wallhaven.cc/full/e7/wallhaven-e7z65r.jpg');
      
    }

    
      #signature {/*signature*/
        background-image: url('/img/signature/1127.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#Notes" title="Notes">Notes</a>
              
              <a class="tag" href="/tags/#Computer Organization" title="Computer Organization">Computer Organization</a>
              
            </div>
            <h1>Computer Organization</h1>
            <h2 class="subheading">Studying Notes</h2>
            <span class="meta">
              Posted by MichaelChen on
              2021-01-19
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">9</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">2.7k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- 不蒜子统计 start -->
            <span class="meta">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            <!-- WordCount end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



	<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
	<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <h1 id="计算机组成原理"><a href="#计算机组成原理" class="headerlink" title="计算机组成原理"></a>计算机组成原理</h1><h2 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h2><h3 id="计算机系统的层次结构"><a href="#计算机系统的层次结构" class="headerlink" title="计算机系统的层次结构"></a>计算机系统的层次结构</h3><p>第一层是微程序设计级。这是计算机的最底层——硬件层，它的设计方式：一种是微程序设计方式，另一种是硬布线设计方式。第二层是机器指令系统级，它所提供的是那些计算机硬件可以读懂并可直接操作计算机硬件工作的二进制信息。第三层是操作系统级即虚拟机，它由操作系统负责实现。这是计算机操作系统的操作者和管理员所见到的计算机系统。第四层是语言处理程序及其他系统软件级。语言处理程序的功能是用翻译程序将高级语言编写的源程序翻译成机器语言程序。第五层是面向 用户的应用程序级。它是针对计算机用户在某一应用领域为专门问题而开发的应用软件。</p>
<p> 计算机系统由硬件系统和软件系统组成。</p>
<h3 id="计算机的性能指标"><a href="#计算机的性能指标" class="headerlink" title="计算机的性能指标"></a>计算机的性能指标</h3><p>机器字长；存储容量；运算速度；可配置的外围设备；性能价格比；可靠性、可维护性和可用性</p>
<h3 id="冯诺依曼体系结构"><a href="#冯诺依曼体系结构" class="headerlink" title="冯诺依曼体系结构"></a>冯诺依曼体系结构</h3><ul>
<li><p>组成（5部分）：运算器、存储器、控制器、输入设备、输出设备 </p>
</li>
<li><p>五个特点：1、采用二进制形式表示数据和指令；指令由操作码和地址码组成。2、采用存储程序，即把编写好的程序和原始数据预先放入计算机存储器中，使计算机工作时能够连续、自动、高速地从存储器中取出一条条指令并执行。3、指令的执行时顺序的，即一般按照指令在存储器中存放的顺序执行，程序分支由转移指令实现。4、计算机硬件系统由运算器、控制器、存储器、输入设备和输出设备五大部件组成，并规定五大不见的基本功能。5、计算机以运算器为中心，输入输出设备与存储器之间的数据传送通过运算器完成</p>
</li>
</ul>
<p><img src="/2021/01/19/Computer-Organization/2.png" alt></p>
<ul>
<li>存储器：计算机用于存放指令和数据的部件</li>
<li>运算器：在控制器的控制下，完成加减乘除运算、逻辑运算</li>
<li>控制器：计算机的控制部件，也是整个计算机的控制中心，其功能是对当前指令所需要完成的操作进行译码分析，产生各个部件所需要的控制信号，通过向计算机的各个部件发送控制信号，使整个计算机自动、协调地工作</li>
<li>输入设备：向计算机输入信息的设备</li>
<li>输出设备：将计算机的处理结果转换成人们或其他设备所能接收的形式</li>
</ul>
<h2 id="第三章（计算题）"><a href="#第三章（计算题）" class="headerlink" title="第三章（计算题）"></a>第三章（计算题）</h2><h3 id="数据的表示（补码、反码、译码）"><a href="#数据的表示（补码、反码、译码）" class="headerlink" title="数据的表示（补码、反码、译码）"></a>数据的表示（补码、反码、译码）</h3><h4 id="原码"><a href="#原码" class="headerlink" title="原码"></a>原码</h4><p>正数符号位为0，负数符号位为1</p>
<h4 id="补码"><a href="#补码" class="headerlink" title="补码"></a>补码</h4><p>取反码后+1</p>
<p><code>0：+；1：-</code></p>
<p>定点整数：结果不带符号位</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113152205055.png" alt="image-20210113152205055"></p>
<p>小数：结果不带符号位</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113152341023.png" alt="image-20210113152341023"></p>
<h4 id="反码"><a href="#反码" class="headerlink" title="反码"></a>反码</h4><p>按位取反</p>
<p>定点整数：结果不带符号位</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113152456733.png" alt="image-20210113152456733"></p>
<p>小数：结果不带符号位</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113152508758.png" alt="image-20210113152508758"></p>
<h4 id="移码"><a href="#移码" class="headerlink" title="移码"></a>移码</h4><p><code>1：+；0：-</code>，数值部分等同于补码</p>
<p>定点整数：</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113152535614.png" alt="image-20210113152535614"></p>
<h3 id="浮点数-P83例题"><a href="#浮点数-P83例题" class="headerlink" title="浮点数 P83例题"></a>浮点数 P83例题</h3><p>浮点数由三个决定其数值大小：阶码E、尾数M和阶码的底R<br>$$<br>N=M \times R^E<br>$$<br><img src="/2021/01/19/Computer-Organization/IMG_20210113_185300.jpg" alt="IMG_20210113_185300"></p>
<h2 id="第四章（电路）"><a href="#第四章（电路）" class="headerlink" title="第四章（电路）"></a>第四章（电路）</h2><h3 id="加法P104"><a href="#加法P104" class="headerlink" title="加法P104"></a>加法P104</h3><p><img src="/2021/01/19/Computer-Organization/image-20210113185941688.png" alt="image-20210113185941688"></p>
<p><img src="/2021/01/19/Computer-Organization/IMG_20210113_190447.jpg" alt="IMG_20210113_190447"></p>
<h3 id="P108-补码的加减运算-画出来-控制信号"><a href="#P108-补码的加减运算-画出来-控制信号" class="headerlink" title="P108 补码的加减运算 画出来 控制信号"></a>P108 补码的加减运算 画出来 控制信号</h3><p>溢出情况</p>
<table>
<thead>
<tr>
<th>运算</th>
<th>操作数X</th>
<th>操作数Y</th>
<th>结果S</th>
</tr>
</thead>
<tbody><tr>
<td>X+Y</td>
<td>正数</td>
<td>正数</td>
<td>负数</td>
</tr>
<tr>
<td>X+Y</td>
<td>负数</td>
<td>负数</td>
<td>正数</td>
</tr>
<tr>
<td>X-Y</td>
<td>负数</td>
<td>正数</td>
<td>正数</td>
</tr>
<tr>
<td>X-Y</td>
<td>正数</td>
<td>负数</td>
<td>负数</td>
</tr>
</tbody></table>
<p><img src="/2021/01/19/Computer-Organization/image-20210113191637744.png" alt="image-20210113191637744"></p>
<p><img src="/2021/01/19/Computer-Organization/C:%5CUsers%5Casus.LAPTOP-2G7HAQG1%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210113192412544.png" alt="image-20210113192412544">)为加减法控制，0为加法1为减法。A中存放的是被减数/被加数的补码。B中存放的为减数/加数的补码。当<img src="/2021/01/19/Computer-Organization/C:%5CUsers%5Casus.LAPTOP-2G7HAQG1%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210113192418657.png" alt="image-20210113192418657">)为1时，B取反，然后+<img src="/2021/01/19/Computer-Organization/C:%5CUsers%5Casus.LAPTOP-2G7HAQG1%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210113192418657.png" alt="image-20210113192418657">达到减数的补码变为-减数的补码，完成减法运算</p>
<p>Ct为符号位，C1为进位位，如果二者异或，v为1是溢出</p>
<h3 id="BCD码"><a href="#BCD码" class="headerlink" title="BCD码"></a>BCD码</h3><p>BCD码这种编码形式利用了四个位元来储存一个十进制的数码，使二进制)和十进制之间的转换得以快捷的进行。</p>
<h3 id="P112-8421加法器"><a href="#P112-8421加法器" class="headerlink" title="P112 8421加法器"></a>P112 8421加法器</h3><p>8421指每个二进制位上所代表的数字的大小分别为8、4、2、1</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113193345859.png" alt="image-20210113193345859"></p>
<p>p=1，+6校正，否则不需要校验</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113193534044.png" alt></p>
<p>输入的A8、A4、A2、A1；B8、B4、B2、B1，进行运算，得出四位结果S’以及一位进位位C，进行判断S‘的值是否大于9，则进行逻辑判断，得出C1，如果C1=1，则0110=6与S’进行加法运算，进行修正</p>
<h3 id="P115-原码乘法"><a href="#P115-原码乘法" class="headerlink" title="P115 原码乘法"></a>P115 原码乘法</h3><ul>
<li>手工计算乘法</li>
</ul>
<p><img src="/2021/01/19/Computer-Organization/image-20210113194804221.png" alt="image-20210113194804221"></p>
<ul>
<li><p>绝对值乘法的机器算法：从乘数的最低位开始，每次根据乘数位得到其位积，乘数位为0，位积为0，乘数位为1，则位积为被乘数；用原部分积右移一位加上本次位积，得到新部分积；初始部分积为0；循环累加右移n次</p>
</li>
<li><p>原码一位乘法</p>
<p>符号位单独提出，做异或运算</p>
<p>之后进行绝对值乘法运算</p>
<img src="/2021/01/19/Computer-Organization/IMG_20210113_202405.jpg" style="zoom:25%;">

<p><img src="/2021/01/19/Computer-Organization/image-20210113202629741.png" alt="image-20210113202629741"></p>
</li>
</ul>
<h3 id="P119-补码乘法-booth算法"><a href="#P119-补码乘法-booth算法" class="headerlink" title="P119 补码乘法 booth算法"></a>P119 补码乘法 booth算法</h3><ul>
<li><p>补码的乘法</p>
<p>x的补码乘以y的数值部分，加上y的符号位乘以-x的补码，结果积为补码</p>
<p><img src="/2021/01/19/Computer-Organization/image-20210113210208072.png" alt="image-20210113210208072"></p>
</li>
<li><p>Booth算法</p>
<p>1、被乘数X和乘数Y均以补码的形式参与乘法运算，运算结果是积的补码</p>
<p>2、部分积和被乘数X采用双符号位，乘数Y采用单符号位</p>
<p>3、初始部分积为0，运算前，在乘数Y的补码末位后添加一位附加位Yn+1，初始值为0.</p>
<p>4、根据YnYn+1的值，查表，累加右移操作。</p>
<table>
<thead>
<tr>
<th>Yn</th>
<th>Yn+1</th>
<th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>+0，右移一位</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>+[x]补，右移一位</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>+[-x]补，右移一位</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>+0，右移一位</td>
</tr>
</tbody></table>
<p>5、累加n+1次，右移n次，最后一次算出结果后不右移</p>
<img src="/2021/01/19/Computer-Organization/IMG_20210113_212232.jpg" alt="IMG_20210113_212232" style="zoom:50%;">

</li>
</ul>
<h2 id="第五章（重点）"><a href="#第五章（重点）" class="headerlink" title="第五章（重点）"></a>第五章（重点）</h2><h3 id="存储器的层次结构"><a href="#存储器的层次结构" class="headerlink" title="存储器的层次结构"></a>存储器的层次结构</h3><p>位于最上层的是寄存器，它的容量很小，访问时间是几个纳秒，可以满足CPU的要求。第二层是高速缓存，他的容量可以是几兆字节，它的的访问时间是寄存器的几倍。第三层是主存，在各种不同类型的存储器里，贮存是最重要的部分，因为计算机当前正在执行的程序和处理的数据都是存放在主存中的，任何程序如果要在计算机中执行，首先必须将其调入主存。主存容量一般在几十到数千兆字节之间，他的访问时间是几十个纳秒。再往下是辅存，它的容量更大，包括硬盘、软盘、光盘等，速度更慢</p>
<h3 id="存储器的性能指标"><a href="#存储器的性能指标" class="headerlink" title="存储器的性能指标"></a>存储器的性能指标</h3><p>存储器的性能指标主要有3个：存储容量、速度和价格</p>
<h3 id="存储单元的实现"><a href="#存储单元的实现" class="headerlink" title="存储单元的实现"></a>存储单元的实现</h3><p><img src="/2021/01/19/Computer-Organization/IMG_20210113_214553.jpg" alt="IMG_20210113_214553"></p>
<table>
<thead>
<tr>
<th>RAM和DRAM的主要异同点：</th>
<th>SRAM</th>
<th>DRAM</th>
</tr>
</thead>
<tbody><tr>
<td>使用的MOS管</td>
<td>SRAM使用的MOS管多</td>
<td>DRAM使用的MOS管少</td>
</tr>
<tr>
<td>功耗与集成度</td>
<td>功耗高，集成度低</td>
<td>功耗低，集成度高</td>
</tr>
<tr>
<td>是否需要刷新</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>读写速度</td>
<td>快</td>
<td>慢</td>
</tr>
</tbody></table>
<h3 id="Cache（基本原理、程序的局部性原理、地址映射方式、替换算法）"><a href="#Cache（基本原理、程序的局部性原理、地址映射方式、替换算法）" class="headerlink" title="Cache（基本原理、程序的局部性原理、地址映射方式、替换算法）"></a>Cache（基本原理、程序的局部性原理、地址映射方式、替换算法）</h3><ul>
<li><p>基本原理：<br>cache是一种小容量高速缓冲存储器，由快速的SRAM组成，直接制作在CPU芯片内，速度几乎与CPU一样快。在CPU和主存之间设置cache，总是把主存中频繁访问的活跃程序和数据块复制到cache中。由于程序访问的局部性，CPU几乎总能从cache中取得指令和数据，而不必访问主存。为便于cache和主存间交换信息，cache和主存空间都被划分为相等的区域。主存中的区域称为块（主存块），它是cache和主存之间信息交换的单位；cache中存放的一个主存块的区域称为行或槽。因此，主存块大小等于cache行中数据区小。</p>
</li>
<li><p>程序局部性原理：在较短的时间内，程序产生的地址往往集中在一个很小的范围内，这种现象被称为程序访问的局部性：空间局部性、时间局部性</p>
</li>
<li><p>地址映射方式：</p>
<ul>
<li>直接映射：主存中的一个块只能映射到Cache的某一特定块中去。</li>
<li>全相联映射：主存中任何一块都可以映射到Cache中的任何一块位置上。</li>
<li>组相联映射：主存和Cache都分组，主存中一个组内的块数与Cache中的分组数相同，组间采用直接映射，组内采用全相联映射。</li>
</ul>
</li>
<li><p>替换算法：</p>
<ul>
<li><p>随机替换算法：在发生替换时，该算法随机挑选一个候选的Cache行来进行替换，而与使用情况无关。</p>
</li>
<li><p>先进先出算法：把最先导入的哪一个Cache行替换出去</p>
</li>
<li><p>最近最少使用算法：统计哪一个Cache行是近段时间内使用次数最少的Cache行，需要替换时就将它替换出去</p>
</li>
</ul>
</li>
</ul>
<h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><ul>
<li>字拓展：作为整体顺序编址</li>
<li>位拓展：地址相同的存储器拼接起来</li>
<li>字位拓展：按照字扩展的方式增加存储器字的数量，同时按照位扩展的方法增加存储字长</li>
</ul>
<h3 id="主存储器与CPU的连接-P228-179-183（综合题）"><a href="#主存储器与CPU的连接-P228-179-183（综合题）" class="headerlink" title="主存储器与CPU的连接 P228 179-183（综合题）"></a>主存储器与CPU的连接 P228 179-183（综合题）</h3><h2 id="第六章-指令系统（简答题）"><a href="#第六章-指令系统（简答题）" class="headerlink" title="第六章 指令系统（简答题）"></a>第六章 指令系统（简答题）</h2><h3 id="P245-CISC的特点"><a href="#P245-CISC的特点" class="headerlink" title="P245 CISC的特点"></a>P245 CISC的特点</h3><p>指令系统复杂，具体表现为指令条数多、寻址方式多、指令格式多。CPU采用微程序控制实现指令的绘制执行，有较多的寄存器。由于指令丰富，程序员编程时有较大的选择空间，缩短了汇编指令条数。</p>
<h3 id="P246-RISC的特点"><a href="#P246-RISC的特点" class="headerlink" title="P246 RISC的特点"></a>P246 RISC的特点</h3><p>指令系统设计时选择一些使用频度较高的简单指令，指令长度固定且操作码位置固定，指令格式种类少，寻址方式减少且简化。CPU中通用寄存器的数量相当多，可以减少访存次数。可以充分利用VLSI芯片的面积，给设计单芯片处理器带来很多好处，有利于提高性能。</p>
<h2 id="第七章"><a href="#第七章" class="headerlink" title="第七章"></a>第七章</h2><h3 id="控制器的组成"><a href="#控制器的组成" class="headerlink" title="控制器的组成"></a>控制器的组成</h3><p>程序计数器、指令寄存器、指令译码器、操作控制信号形成部件、时序信号产生器、地址寄存器、数据寄存器</p>
<h3 id="单周期的硬布线控制器设计（综合题、实验十）"><a href="#单周期的硬布线控制器设计（综合题、实验十）" class="headerlink" title="单周期的硬布线控制器设计（综合题、实验十）"></a>单周期的硬布线控制器设计（综合题、实验十）</h3>

        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          
          <li class="next">
            <a href="/2020/12/03/Linux-process-call-thread/" data-toggle="tooltip" data-placement="top" title="Linux process call thread">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <div class="tip">
          <p>
            If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
          </p>
        </div>
        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=Computer Organization&body=Hi,I found this website and thought you might like it https://michaelchen-ice.github.io/2021/01/19/Computer-Organization/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

<!-- gitalk start -->
<!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

<div id="gitalk-container"></div>

<!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
<script src="/js/comment/gitalk.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '6afc8e79f03609e6233e',
    clientSecret: '2dc23872b4b80fa707f9390ea08bff79c1d280f8',
    repo: 'gitTalk',
    owner: 'Michaelchen-ice',
    admin: 'Michaelchen-ice',
    id: 'Tue Jan 19 2021 17:23:41 GMT+0800', // Ensure uniqueness and length less than 50
    distractionFreeMode: false, // Facebook-like distraction free mode
    perPage: 10 ,
    pagerDirection: 'last',
    createIssueManually: false ,
    language: 'zh-CN'
  });
  gitalk.render('gitalk-container');

  var gtFolded = () => {
    setTimeout(function() {
      let markdownBody = document.getElementsByClassName("markdown-body");
      let list = Array.from(markdownBody);
      list.forEach(item => {
        if (item.clientHeight > 250) {
          item.classList.add('gt-comment-body-folded');
          item.style.maxHeight = '250px';
          item.title = 'Click to Expand';
          item.onclick = function() {
            item.classList.remove('gt-comment-body-folded');
            item.style.maxHeight = '';
            item.title = '';
            item.onclick = null;
          };
        }
      })
    }, 800);
  }
</script>

<!-- gitalk end -->



<!-- 2. gitment comment -->



<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#计算机组成原理"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">计算机组成原理</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#第一章"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">第一章</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#计算机系统的层次结构"><span class="toc-nav-number">1.1.1.</span> <span class="toc-nav-text">计算机系统的层次结构</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#计算机的性能指标"><span class="toc-nav-number">1.1.2.</span> <span class="toc-nav-text">计算机的性能指标</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#冯诺依曼体系结构"><span class="toc-nav-number">1.1.3.</span> <span class="toc-nav-text">冯诺依曼体系结构</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#第三章（计算题）"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">第三章（计算题）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#数据的表示（补码、反码、译码）"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">数据的表示（补码、反码、译码）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#原码"><span class="toc-nav-number">1.2.1.1.</span> <span class="toc-nav-text">原码</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#补码"><span class="toc-nav-number">1.2.1.2.</span> <span class="toc-nav-text">补码</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#反码"><span class="toc-nav-number">1.2.1.3.</span> <span class="toc-nav-text">反码</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#移码"><span class="toc-nav-number">1.2.1.4.</span> <span class="toc-nav-text">移码</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#浮点数-P83例题"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">浮点数 P83例题</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#第四章（电路）"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">第四章（电路）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#加法P104"><span class="toc-nav-number">1.3.1.</span> <span class="toc-nav-text">加法P104</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#P108-补码的加减运算-画出来-控制信号"><span class="toc-nav-number">1.3.2.</span> <span class="toc-nav-text">P108 补码的加减运算 画出来 控制信号</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#BCD码"><span class="toc-nav-number">1.3.3.</span> <span class="toc-nav-text">BCD码</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#P112-8421加法器"><span class="toc-nav-number">1.3.4.</span> <span class="toc-nav-text">P112 8421加法器</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#P115-原码乘法"><span class="toc-nav-number">1.3.5.</span> <span class="toc-nav-text">P115 原码乘法</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#P119-补码乘法-booth算法"><span class="toc-nav-number">1.3.6.</span> <span class="toc-nav-text">P119 补码乘法 booth算法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#第五章（重点）"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">第五章（重点）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#存储器的层次结构"><span class="toc-nav-number">1.4.1.</span> <span class="toc-nav-text">存储器的层次结构</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#存储器的性能指标"><span class="toc-nav-number">1.4.2.</span> <span class="toc-nav-text">存储器的性能指标</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#存储单元的实现"><span class="toc-nav-number">1.4.3.</span> <span class="toc-nav-text">存储单元的实现</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Cache（基本原理、程序的局部性原理、地址映射方式、替换算法）"><span class="toc-nav-number">1.4.4.</span> <span class="toc-nav-text">Cache（基本原理、程序的局部性原理、地址映射方式、替换算法）</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#拓展"><span class="toc-nav-number">1.4.5.</span> <span class="toc-nav-text">拓展</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#主存储器与CPU的连接-P228-179-183（综合题）"><span class="toc-nav-number">1.4.6.</span> <span class="toc-nav-text">主存储器与CPU的连接 P228 179-183（综合题）</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#第六章-指令系统（简答题）"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">第六章 指令系统（简答题）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#P245-CISC的特点"><span class="toc-nav-number">1.5.1.</span> <span class="toc-nav-text">P245 CISC的特点</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#P246-RISC的特点"><span class="toc-nav-number">1.5.2.</span> <span class="toc-nav-text">P246 RISC的特点</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#第七章"><span class="toc-nav-number">1.6.</span> <span class="toc-nav-text">第七章</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#控制器的组成"><span class="toc-nav-number">1.6.1.</span> <span class="toc-nav-text">控制器的组成</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#单周期的硬布线控制器设计（综合题、实验十）"><span class="toc-nav-number">1.6.2.</span> <span class="toc-nav-text">单周期的硬布线控制器设计（综合题、实验十）</span></a></li></ol></li></ol></li></ol>
        
        </div>
      </aside>
    


      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#Notes" title="Notes">Notes</a>
            
            <a class="tag" href="/tags/#Computer Organization" title="Computer Organization">Computer Organization</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://github.com/Michaelchen-ice" target="_blank">MichaelChen</a>
          </li>
          
          <li>
            <a href="https://shadowapril.github.io/" target="_blank">April</a>
          </li>
          
          <li>
            <a href="https://hexo.io/" target="_blank">Hexo</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



	<!-- Footer (contains ThemeColor、viewer) -->
	<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/Michaelchen-ice">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          
            <li>
              <a target="_blank" href="https://twitter.com/茗天">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          
            <li>
              <a target="_blank" href="https://www.zhihu.com/people/Michael陈">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa  fa-stack-1x fa-inverse">知</i>
                </span>
              </a>
            </li>
          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          MichaelChen
          2021
          <br>
          Theme by
          <a href="http://beantech.org" target="_blank" rel="noopener">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a href="https://v-vincen.life/" target="_blank" rel="noopener">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>

<!-- jQuery -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!-- <script type="text/javascript" src="/js/jquery.js"></script> -->
<!-- <script type="text/javascript" src="//cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->

<!-- Bootstrap Core JavaScript -->
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script type="text/javascript" src="/js/hux-blog.min.js"></script>

<!-- catalog -->
<script type="text/javascript" async="true" src="/js/catalog.js?v=1.0.0"></script>

<!-- totop(rocket) -->
<script type="text/javascript" async="true" src="/js/totop.js?v=1.0.0"></script>

<!-- Busuanzi JavaScript -->
<script type="text/javascript" async="true" src="/js/busuanzi.pure.mini.js"></script>


  <!-- Scroll start -->
  <script type="text/javascript" src="/js/scroll.js"></script>
  <!-- Scroll end -->



  <!-- ThemeColor start -->
  <script type="text/javascript" src="/js/themecolor.js"></script>
  <!-- ThemeColor end -->





  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  <script type="text/javascript" src="/js/viewer/viewer.min.js"></script>
  <script type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){ hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if($('#tag_cloud').length !== 0){ async("https://michaelchen-ice.github.io/js/jquery.tagcloud.js",function(){ $.fn.tagcloud.defaults = { //size: {start: 1, end: 1, unit: 'em'}, color: {start:
'#bbbbee', end: '#0085a1'}, }; $('#tag_cloud a').tagcloud(); }) } </script> -->


	<!-- Search -->
	
	<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/ziploader.js"></script>
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;

            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


	

	<!-- Image to hack wechat -->
	<!-- <img src="https://michaelchen-ice.github.io/img/icon_wechat.png" width="0" height="0" /> -->
	<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
